## links
* 以下信息量较少：
* [ZDI-24-1643 | Zero Day Initiative](https://www.zerodayinitiative.com/advisories/ZDI-24-1643/
* [TrueNAS CORE Vulnerability Let Attackers Execute Remote Code](https://gbhackers.com/truenas-core-vulnerability/)
* [CVE-2024-11944: TrueNAS CORE Vulnerability Allows Unauthenticated Attacks](https://securityonline.info/cve-2024-11944-truenas-core-vulnerability-allows-unauthenticated-attacks/)

* 以下较为详细：
* https://avd.aquasec.com/nvd/2024/cve-2024-11944/ （包含最详细的漏洞描述和漏洞利用思路CAPEC）
* https://cyber.vumetric.com/vulns/CVE-2024-11944/ （包含利用思路CAPEC）
* [CVE-2024-11944 Security Vulnerability & Exploit Details](https://cve.akaoma.com/cve-2024-11944)（包含利用思路CAPEC）
* https://thecyberthrone.in/2025/01/04/cve-2024-11944-truenas-core-has-severe-directory-traversal-flaw/ （包含利用思路CAPEC）
* [CVE-2024-11944 - Exploits & Severity - Feedly](https://feedly.com/cve/CVE-2024-11944)
* [CVE-2024-11944 : Directory Traversal Remote Code Execution Vulnerability in iXsystems TrueNAS CORE | SecurityVulnerability.io](https://securityvulnerability.io/vulnerability/CVE-2024-11944)
## What is CVE-2024-11944?

CVE-2024-11944 is a directory traversal remote code execution vulnerability affecting iXsystems TrueNAS CORE, a widely-used open-source storage operating system designed for data management and storage purposes. This vulnerability enables unauthorized network-adjacent attackers to execute arbitrary code on vulnerable installations without requiring authentication. The exploitation of this flaw poses significant risks to organizations that rely on TrueNAS CORE for their data infrastructure, potentially allowing attackers to manipulate sensitive data or disrupt operations.
CVE-2024-11944 是一个目录遍历远程代码执行漏洞，影响 iXsystems TrueNAS CORE，这是一个广泛使用的开源存储操作系统，旨在数据管理和存储目的。该漏洞使得未经授权的网络邻近攻击者能够在易受攻击的安装环境上执行任意代码，无需认证。利用此漏洞对依赖 TrueNAS CORE 作为数据基础设施的组织构成重大风险，攻击者可能借此操控敏感数据或破坏运营。
## Technical Details
iXsystems TrueNAS CORE tarfile.extractall Directory Traversal Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of iXsystems TrueNAS devices. Authentication is not required to exploit this vulnerability. The specific flaw exists within the tarfile.extractall method. The issue results from the lack of proper validation of a user-supplied path prior to using it in file operations. The lack of stringent checks on user inputs leads to a scenario where an attacker could manipulate the file extraction process to gain escalated privileges, possibly executing code with root privileges.Was ZDI-CAN-25626.
iXsystems TrueNAS CORE 的 `tarfile.extractall` 目录遍历远程代码执行漏洞。  
此漏洞允许网络邻近的攻击者在受影响的 iXsystems TrueNAS 设备上执行任意代码。利用此漏洞不需要身份验证。具体的缺陷存在于 `tarfile.extractall` 方法中。问题的根源在于未对用户提供的路径在文件操作前进行适当验证。由于缺乏对用户输入的严格检查，攻击者可以操控文件提取过程，从而获得提升的权限，可能以 root 权限执行代码。
漏洞编号：
ZDI-24-1643  
ZDI-CAN-25626

更详细的漏洞代码位置，没有找到详细的描述，只知道漏洞存在于`tarfile.extractall` 方法中。问题的根源在于未对用户提供的路径在文件操作前进行适当验证。
## Weakness and Exploitation Mechanism
**1. Nature of the Vulnerability**:
- The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory.The core issue lies within the `tarfile.extractall` method used in TrueNAS CORE. This method fails to validate user-supplied paths correctly before using them in file operations, leading to a directory traversal vulnerability.
- 该产品使用外部输入构造一个路径名，目的是识别位于受限父目录下的文件或目录。核心问题在于 TrueNAS CORE 中使用的 `tarfile.extractall` 方法。该方法在执行文件操作之前未能正确验证用户提供的路径，从而导致了目录遍历漏洞。
**2. Exploitation Mechanism**:
- **Directory Traversal**: Attackers can exploit this vulnerability by crafting a malicious tar archive containing files with specially constructed file paths. When the `tarfile.extractall` method processes this archive, it inadvertently extracts files to unintended locations on the filesystem. This allows the attacker to write files outside the intended directory, potentially overwriting critical system files or introducing malicious files.
- **目录遍历**：攻击者可以通过构造一个包含具有特殊构造文件路径的文件的恶意 tar 归档文件来利用此漏洞。当 `tarfile.extractall` 方法处理该归档文件时，它会不小心将文件提取到文件系统中的非预期位置。这允许攻击者将文件写入预定目录之外的地方，可能会覆盖关键系统文件或引入恶意文件。
- **Remote Code Execution**: By leveraging the directory traversal flaw, attackers can place executable files in locations where they will be run with elevated privileges. This can lead to the execution of arbitrary code in the context of the root user, giving the attacker complete control over the affected system.
- **远程代码执行**：通过利用目录遍历漏洞，攻击者可以将可执行文件放置在某些位置，这些文件会以提升的权限运行。这可能导致在 root 用户的上下文中执行任意代码，从而使攻击者完全控制受影响的系统。

## Extended Description
Many file operations are intended to take place within a restricted directory. By using special elements such as “..” and “/” separators, attackers can escape outside of the restricted location to access files or directories that are elsewhere on the system. One of the most common special elements is the “../” sequence, which in most modern operating systems is interpreted as the parent directory of the current location. This is referred to as relative path traversal. Path traversal also covers the use of absolute pathnames such as “/usr/local/bin”, which may also be useful in accessing unexpected files. This is referred to as absolute path traversal. In many programming languages, the injection of a null byte (the 0 or NUL) may allow an attacker to truncate a generated filename to widen the scope of attack. For example, the product may add “.txt” to any pathname, thus limiting the attacker to text files, but a null injection may effectively remove this restriction.
许多文件操作旨在在受限目录中进行。通过使用特殊元素（如 “..” 和 “/” 分隔符），攻击者可以逃逸到受限位置之外，以访问系统上其他位置的文件或目录。最常见的特殊元素之一是 “../” 序列，在大多数现代操作系统中，它被解释为当前位置的父目录。这称为相对路径遍历。路径遍历还包括绝对路径名的使用，例如 “/usr/local/bin”，这在访问意外文件时也可能很有用。这被称为绝对路径遍历。在许多编程语言中，注入空字节（0 或 NUL）可能允许攻击者截断生成的文件名，从而扩大攻击范围。例如，产品可以在任何路径名中添加 “.txt”，从而将攻击者限制为文本文件，但 null 注入可能会有效地消除此限制。

## Potential Impact of CVE-2024-11944
Since the attack does not require prior authentication, network-adjacent attackers—those on the same network or able to access the device—can exploit the vulnerability. Once exploited, the attacker could potentially gain full control of the affected NAS, leading to severe consequences such as:
由于该攻击不需要事先认证，因此网络邻近的攻击者——即位于同一网络或能够访问设备的攻击者——可以利用此漏洞。一旦被利用，攻击者可能会获得受影响的 NAS 的完全控制权，导致严重后果，例如：
1. **Remote Code Execution**: The most critical impact is the potential for remote code execution, allowing attackers to run malicious code on affected systems, which can lead to unauthorized access and full control over the storage system.
2. **Data Compromise**: Exploitation of this vulnerability may result in data breaches, where sensitive information stored on the TrueNAS servers could be accessed, altered, or deleted by unauthorized personnel.
3. **Operational Disruption**: The ability for attackers to execute arbitrary code opens up pathways for destructive actions, such as data corruption or service disruption, affecting the reliability and availability of critical storage resources for organizations.

1. **远程代码执行**：最严重的影响是可能发生远程代码执行，攻击者可以在受影响的系统上运行恶意代码，从而导致未经授权的访问并完全控制存储系统。
2. **数据泄露**：利用此漏洞可能导致数据泄露，存储在 TrueNAS 服务器上的敏感信息可能被未经授权的人员访问、篡改或删除。
3. **操作中断**：攻击者执行任意代码的能力为破坏性操作提供了途径，如数据损坏或服务中断，这会影响组织关键存储资源的可靠性和可用性。

## Common Attack Pattern Enumeration and Classification (CAPEC)

### Relative Path Traversal
An attacker exploits a weakness in input validation on the target by supplying a specially constructed path utilizing dot and slash characters for the purpose of obtaining access to arbitrary files or resources. An attacker modifies a known path on the target in order to reach material that is not available through intended channels. These attacks normally involve adding additional path separators (/ or \) and/or dots (.), or encodings thereof, in various combinations in order to reach parent directories or entirely separate trees of the target's directory structure.
攻击者利用目标系统输入验证的弱点，提供一个特别构造的路径，利用点（`.`）和斜杠（`/`）字符，目的是获得对任意文件或资源的访问。攻击者修改目标上已知的路径，以便访问通过预定渠道无法获得的内容。这些攻击通常涉及在路径中添加额外的路径分隔符（`/` 或 `\`）和/或点（`.`），或者它们的编码，以不同的组合方式访问父目录或完全独立的目录树结构。


下面是GPT给出的一个简单样例解释：
在这种攻击中，攻击者通常通过以下方式来操控路径：
- 添加额外的路径分隔符（如斜杠 `/` 或反斜杠 `\`），
- 使用点（`.`）来代表当前目录或父目录（如 `../` 表示上级目录），
- 或者通过对这些字符进行编码（如 URL 编码），以规避简单的输入过滤机制。

假设我们有一个 Web 应用，它允许用户通过输入文件路径来访问存储在服务器上的某些文件。应用程序的输入没有经过严格的验证，攻击者可以利用这一点进行路径遍历攻击。

假设应用程序的代码如下所示：

```python
def view_file(file_path):
    base_path = "/home/user/files/"
    with open(base_path + file_path, "r") as file:
        return file.read()
```

用户可以通过输入路径来访问服务器上的文件。如果用户输入的路径为 `report.txt`，应用程序将尝试打开 `/home/user/files/report.txt`。

攻击者可以输入类似以下的路径：

```
../../etc/passwd
```

这里，`../../` 是相对路径，用来跳出当前目录并进入父级目录。攻击者的输入将使得应用程序构造出以下路径：

```
/home/user/files/../../etc/passwd
```

这将导致应用程序访问服务器的 `/etc/passwd` 文件，而该文件通常包含系统用户的敏感信息。这是因为攻击者通过路径遍历绕过了原本应该限制访问的目录结构。

- 攻击者成功获取了 `/etc/passwd` 文件的内容。
- 服务器上的其他敏感文件也可能暴露，导致数据泄露、权限提升等安全问题。

解决方法：

- 进行严格的输入验证，确保路径只能指向允许的目录。
- 使用绝对路径而不是基于输入构造路径。
- 过滤掉 `../` 等路径遍历字符，或对输入路径进行规范化处理，确保不会跳出预期目录。

### Directory Traversal
An attacker with access to file system resources, either directly or via application logic, will use various file path specification or navigation mechanisms such as ".." in path strings and absolute paths to extend their range of access to inappropriate areas of the file system. The attacker attempts to either explore the file system for recon purposes or access directories and files that are intended to be restricted from their access. Exploring the file system can be achieved through constructing paths presented to directory listing programs, such as "ls" and 'dir', or through specially crafted programs that attempt to explore the file system. The attacker engaging in this type of activity is searching for information that can be used later in a more exploitive attack. Access to restricted directories or files can be achieved through modification of path references utilized by system applications.
攻击者如果能够访问文件系统资源，无论是直接访问还是通过应用程序逻辑访问，都会利用各种文件路径规范或导航机制，如路径字符串中的 `..` 或绝对路径，来扩展其访问范围，进入文件系统中不应访问的区域。攻击者试图通过探索文件系统进行侦察，或者访问本应受到限制的目录和文件。探索文件系统可以通过构造路径并将其传递给目录列出程序（如 `ls` 和 `dir`）来实现，或者通过特别设计的程序来尝试探索文件系统。参与这种活动的攻击者正在寻找可以在后续更具破坏性的攻击中使用的信息。访问受限的目录或文件通常是通过修改系统应用程序使用的路径引用来实现的。

下面是GPT给出的示例：
假设一个 Web 应用程序允许用户通过输入文件路径来访问服务器上的文件，但没有对用户输入的路径进行严格验证，存在路径遍历漏洞。

```python
def get_file_content(file_path):
    base_path = "/home/user/files/"
    with open(base_path + file_path, "r") as file:
        return file.read()
```

默认情况下，如果用户输入 `document.txt`，应用程序将返回 `/home/user/files/document.txt` 文件的内容。但如果攻击者输入类似以下的路径：

```
../../../../etc/passwd
```

那么程序构造出的文件路径将变成：

```
/home/user/files/../../../../etc/passwd
```

这意味着攻击者实际上访问的是 `/etc/passwd` 文件，通常包含系统用户信息，这是一个敏感文件。

攻击步骤：

1. **文件系统探索**：攻击者首先使用 `..` 来跳出当前目录，探索其他目录。
2. **访问受限文件**：通过精心构造路径，攻击者能够绕过文件访问控制，访问系统敏感文件如 `/etc/passwd`、`/etc/shadow` 或 `/root` 目录中的文件。

### File System Function Injection, Content Based
An attack of this type exploits the host's trust in executing remote content including binary files. The files are poisoned with a malicious payload (targeting the file systems accessible by the target software) by the attacker and may be passed through standard channels such as via email, and standard web content like PDF and multimedia files. The attacker exploits known vulnerabilities or handling routines in the target processes. Vulnerabilities of this type have been found in a wide variety of commercial applications from Microsoft Office to Adobe Acrobat and Apple Safari web browser. When the attacker knows the standard handling routines and can identify vulnerabilities and entry points they can be exploited by otherwise seemingly normal content. Once the attack is executed, the attackers' program can access relative directories such as C:\Program Files or other standard system directories to launch further attacks. In a worst case scenario, these programs are combined with other propagation logic and work as a virus.
此类攻击利用了主机在执行远程内容（包括二进制文件）时的信任。攻击者通过在文件中注入恶意负载（目标是被目标软件可访问的文件系统）来“毒化”文件，这些文件可能通过标准渠道传递，如电子邮件，或者通过标准的网页内容，如 PDF 和多媒体文件。攻击者利用目标进程中已知的漏洞或处理程序。此类漏洞已经在各种商业应用程序中被发现，从 Microsoft Office 到 Adobe Acrobat 以及 Apple Safari 网络浏览器。当攻击者了解标准的处理程序并能识别漏洞和入口点时，这些漏洞就可以通过看似正常的内容被利用。一旦攻击成功，攻击者的程序可以访问类似 C:\Program Files 这样的相对目录或其他标准系统目录，从而发起进一步的攻击。在最坏的情况下，这些程序与其他传播逻辑结合，成为病毒。


下面是GPT总结的攻击过程：
1. **注入恶意负载**：攻击者将恶意代码注入一个看似正常的文件中，如 PDF、文档、图片或视频文件等。
2. **利用目标漏洞**：这些文件通过常见渠道（如电子邮件、文件共享、网页下载等）传输到目标机器。一旦目标软件（如 Adobe Acrobat 或 Microsoft Office）打开这些文件，文件中嵌入的恶意代码就会被执行。
3. **访问文件系统**：恶意代码能够利用目标软件的漏洞，访问并操控文件系统中的敏感区域，如 `C:\Program Files` 或其他标准系统目录，进一步执行恶意行为。
4. **传播和扩散**：在最坏的情况下，恶意代码不仅会对受害系统造成危害，还可能具有自我复制功能，像病毒一样通过其他途径扩散。

### Using Slashes and URL Encoding Combined to Bypass Validation Logic
    
This attack targets the encoding of the URL combined with the encoding of the slash characters. An attacker can take advantage of the multiple way of encoding an URL and abuse the interpretation of the URL. An URL may contain special character that need special syntax handling in order to be interpreted. Special characters are represented using a percentage character followed by two digits representing the octet code of the original character (%HEX-CODE). For instance US-ASCII space character would be represented with %20. This is often referred as escaped ending or percent-encoding. Since the server decodes the URL from the requests, it may restrict the access to some URL paths by validating and filtering out the URL requests it received. An attacker will try to craft an URL with a sequence of special characters which once interpreted by the server will be equivalent to a forbidden URL. It can be difficult to protect against this attack since the URL can contain other format of encoding such as UTF-8 encoding, Unicode-encoding, etc.
**此攻击针对的是 URL 编码和斜杠字符的编码结合。攻击者可以利用 URL 编码的多种方式，并滥用 URL 的解释方式。** URL 中可能包含特殊字符，这些字符需要特定的语法处理才能正确解释。特殊字符通常使用百分号字符（`%`）后跟两个表示原始字符的八位字节码的数字（%HEX-CODE）来表示。例如，US-ASCII 空格字符会被表示为 `%20`。这种方式通常被称为转义结尾或百分号编码（percent-encoding）。由于服务器在解码请求中的 URL 时，可能会通过验证和过滤掉收到的 URL 请求来限制对某些 URL 路径的访问，攻击者会尝试构造一个包含一系列特殊字符的 URL，这些字符在服务器解码后会被解释为一个禁止访问的 URL。由于 URL 可以包含其他编码格式，如 UTF-8 编码、Unicode 编码等，因此防范这种攻击可能会很困难。



下面是GPT的解释：
**使用斜杠和 URL 编码结合绕过验证逻辑**是指攻击者通过结合使用斜杠字符 (`/` 或 `\`) 和 URL 编码（例如 `%2F` 代替 `/`）来绕过目标应用程序或服务器的路径验证机制。这种方法可以利用服务器在解码 URL 时，未能正确处理某些特殊字符或编码格式，从而访问本应受到限制的路径。

示例解释：

假设有一个 Web 应用程序，它通过 URL 路径来访问用户数据。例如，用户可以通过以下 URL 访问自己的文件：

```
http://example.com/files/user12345
```

这个 URL 中的 `files/` 路径可能用于访问存储在 `files` 目录下的文件，而应用程序可能限制用户只能访问自己的文件路径。如果该应用程序使用简单的路径验证机制，它可能会通过检查路径中是否包含 `../` 或 `..` 来防止目录遍历攻击。
**但是，攻击者可以通过结合斜杠字符和 URL 编码，绕过这种路径验证。**

下面是攻击步骤：
1. **正常 URL 请求**： 原始的文件路径是：
    ```
    http://example.com/files/user12345
    ```
2. **攻击者修改 URL 使用 URL 编码**： 攻击者可以将斜杠字符 `/` 替换为其 URL 编码 `%2F`，从而绕过应用程序的路径验证。例如：
    ```
    http://example.com/files%2F../../../etc/passwd
    ```
    这里，`%2F` 是斜杠字符 `/` 的 URL 编码，攻击者用它代替了原本的路径分隔符。
3. **服务器解码和路径解析**： 当服务器接收到这个请求时，它会解码 URL，`%2F` 会被替换回普通的 `/`。因此，URL 变为：
    ```
    http://example.com/files/../../../etc/passwd
    ```
    这将导致应用程序尝试访问 `files` 目录下的 `../../../etc/passwd` 路径，实际上是访问系统的 `etc/passwd` 文件，这通常是一个敏感的系统文件。
4. **绕过路径验证**： 假设应用程序原本通过检查路径中的 `../` 来防止访问父级目录，但是由于斜杠被 URL 编码，路径中的 `../` 被编码为 `%2E%2E%2F`，这导致路径验证无法识别这些特殊字符。最终，攻击者能够成功访问本不应允许访问的文件（如 `/etc/passwd`）。
    
### Manipulating Input to File System Calls
An attacker manipulates inputs to the target software which the target software passes to file system calls in the OS. The goal is to gain access to, and perhaps modify, areas of the file system that the target software did not intend to be accessible.
攻击者操控输入数据，目标软件将这些数据传递给操作系统中的文件系统调用。攻击的目的是访问并可能修改文件系统中目标软件未打算公开的区域。

## Potential Mitigations(缓解措施，与我们无关)

-  Assume all input is malicious. Use an “accept known good” input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.
- 假设所有输入都是恶意的。采用“accept known good”输入验证策略，即，使用一个严格符合规范的可接受输入列表。拒绝任何不严格符合规范的输入，或将其转换为符合规范的输入。
-  When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, “boat” may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as “red” or “blue.”
-  在进行输入验证时，应考虑所有可能相关的属性，包括输入的长度、类型、可接受值的完整范围、缺失或多余的输入、语法、相关字段之间的一致性以及是否符合业务规则。例如，作为业务规则逻辑的一个例子，“boat”可能在语法上是有效的，因为它仅包含字母和数字字符，但如果输入只应包含诸如“red”或“blue”等颜色，那么它就是无效的。
- Do not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input, especially if the code’s environment changes. This can give attackers enough room to bypass the intended validation. However, denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.
- 不要仅仅依赖于查找恶意或格式错误的输入。这可能会漏掉至少一个不良输入，特别是当代码的环境发生变化时。这会给攻击者足够的空间来绕过预期的验证。然而，拒绝列表（denylists）对于检测潜在攻击或判断哪些输入格式错误到应当直接拒绝是有用的。
-  When validating filenames, use stringent allowlists that limit the character set to be used. If feasible, only allow a single “.” character in the filename to avoid weaknesses such as CWE-23, and exclude directory separators such as “/” to avoid CWE-36. Use a list of allowable file extensions, which will help to avoid CWE-434.
- 在验证文件名时，使用严格的允许列表，限制可使用的字符集。如果可行，文件名中仅允许一个“.”字符，以避免如 CWE-23 等漏洞，并排除目录分隔符如“/”，以避免 CWE-36。使用允许的文件扩展名列表，这将有助于避免 CWE-434。
-  Do not rely exclusively on a filtering mechanism that removes potentially dangerous characters. This is equivalent to a denylist, which may be incomplete (CWE-184). For example, filtering “/” is insufficient protection if the filesystem also supports the use of “" as a directory separator. Another possible error could occur when the filtering is applied in a way that still produces dangerous data (CWE-182). For example, if “../” sequences are removed from the “…/…//” string in a sequential fashion, two instances of “../” would be removed from the original string, but the remaining characters would still form the “../” string.
-  Inputs should be decoded and canonicalized to the application’s current internal representation before being validated (CWE-180). Make sure that the application does not decode the same input twice (CWE-174). Such errors could be used to bypass allowlist validation schemes by introducing dangerous inputs after they have been checked.
-  Use a built-in path canonicalization function (such as realpath() in C) that produces the canonical version of the pathname, which effectively removes “..” sequences and symbolic links (CWE-23, CWE-59). This includes:
-  When the set of acceptable objects, such as filenames or URLs, is limited or known, create a mapping from a set of fixed input values (such as numeric IDs) to the actual filenames or URLs, and reject all other inputs.
-  For example, ID 1 could map to “inbox.txt” and ID 2 could map to “profile.txt”. Features such as the ESAPI AccessReferenceMap [REF-185] provide this capability.
-  Run the code in a “jail” or similar sandbox environment that enforces strict boundaries between the process and the operating system. This may effectively restrict which files can be accessed in a particular directory or which commands can be executed by the software.
-  OS-level examples include the Unix chroot jail, AppArmor, and SELinux. In general, managed code may provide some protection. For example, java.io.FilePermission in the Java SecurityManager allows the software to specify restrictions on file operations.
-  This may not be a feasible solution, and it only limits the impact to the operating system; the rest of the application may still be subject to compromise.
-  Be careful to avoid CWE-243 and other weaknesses related to jails.
-  Store library, include, and utility files outside of the web document root, if possible. Otherwise, store them in a separate directory and use the web server’s access control capabilities to prevent attackers from directly requesting them. One common practice is to define a fixed constant in each calling program, then check for the existence of the constant in the library/include file; if the constant does not exist, then the file was directly requested, and it can exit immediately.
-  This significantly reduces the chance of an attacker being able to bypass any protection mechanisms that are in the base program but not in the include files. It will also reduce the attack surface.
-  Ensure that error messages only contain minimal details that are useful to the intended audience and no one else. The messages need to strike the balance between being too cryptic (which can confuse users) or being too detailed (which may reveal more than intended). The messages should not reveal the methods that were used to determine the error. Attackers can use detailed information to refine or optimize their original attack, thereby increasing their chances of success
-  If errors must be captured in some detail, record them in log messages, but consider what could occur if the log messages can be viewed by attackers. Highly sensitive information such as passwords should never be saved to log files.
-  Avoid inconsistent messaging that might accidentally tip off an attacker about internal state, such as whether a user account exists or not.
-  In the context of path traversal, error messages which disclose path information can help attackers craft the appropriate attack strings to move through the file system hierarchy.